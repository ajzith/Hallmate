<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Faculty Dashboard - Hallmate</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body class="bg-light">

<div class="container mt-5">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2>Faculty Dashboard</h2>
    <button id="logoutBtn" class="btn btn-outline-secondary btn-sm">Logout</button>
  </div>

  <!-- Allocations Table -->
  <div class="card">
    <div class="card-header bg-primary text-white">Your Exam Allocations</div>
    <div class="card-body">
      <table class="table table-bordered" id="allocationsTable">
        <thead>
          <tr>
            <th>Subject</th>
            <th>Course Code</th>
            <th>Exam Date</th>
            <th>Session</th>
            <th>Room</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
</div>

<script>
function loadAllocations() {
  $.get("../backend/faculty_dashboard.php", function(res) {
    if (res.success) {
      let rows = "";
      res.allocations.forEach(a => {
        rows += `<tr>
          <td>${a.subject}</td>
          <td>${a.course_code || ""}</td>
          <td>${a.exam_date}</td>
          <td>${a.session}</td>
          <td>${a.room_number}</td>
        </tr>`;
      });
      $("#allocationsTable tbody").html(rows);
    } else {
      alert(res.error || "Failed to load data");
    }
  }, "json");
}

$("#logoutBtn").click(async function() {
  await fetch("../backend/logout.php", { method: "POST", credentials: "same-origin" });
  window.location.href = "login.html";
});

$(document).ready(loadAllocations);
</script>

</body>
</html>
